{# wedding_project/core/templates/core/home.html #}
{% extends "base.html" %}
{% load static %}

{% block title %}Welcome to Our Wedding!{% endblock %}

{% block head_extra %}
    <link rel="stylesheet" href="{% static 'core/css/home.css' %}"> {# PASTE THE LINE HERE #}
{% endblock head_extra %}

{% block content %}

{# Hero Section - Responsive Vertical/Horizontal Carousels #}
<section class="hero-section">
    <div class="hero-overlay">
        <div class="hero-content-wrapper"> {# This new wrapper holds carousels and CTA #}

            {# Left Vertical/Horizontal Carousel #}
            <div class="hero-carousel hero-carousel-left" data-carousel-direction-desktop="up" data-carousel-direction-mobile="left">
                <div class="carousel-inner">
                    <img src="{% static 'core/img/hero_carousel/left_1.jpg' %}" alt="Wedding Image 1" class="carousel-item">
                    <img src="{% static 'core/img/hero_carousel/left_2.jpg' %}" alt="Wedding Image 2" class="carousel-item">
                    <img src="{% static 'core/img/hero_carousel/left_3.jpg' %}" alt="Wedding Image 3" class="carousel-item">
                    <img src="{% static 'core/img/hero_carousel/left_4.jpg' %}" alt="Wedding Image 4" class="carousel-item">
                    <img src="{% static 'core/img/hero_carousel/left_5.jpg' %}" alt="Wedding Image 5" class="carousel-item">
                    {# Add more 'left_' images here if you have them, for a smoother loop #}
                </div>
            </div>

            {# Central CTA Card (Your existing hero-card) #}
            <div class="hero-card">
                <h1>We're Getting Married!</h1>
                <p class="lead">Join us to celebrate our special day on {{ wedding_date }}!</p>
                <div class="hero-buttons">
                    <a href="{% url 'rsvp' %}" class="btn btn-lg btn-wedding-primary">
                        <i class="fas fa-heart"></i> RSVP Now
                    </a>
                    <a href="{% url 'wedding_details' %}" class="btn btn-lg btn-wedding-secondary">
                        <i class="fas fa-calendar-alt"></i> Wedding Details
                    </a>
                </div>
            </div>

            {# Right Vertical/Horizontal Carousel #}
            <div class="hero-carousel hero-carousel-right" data-carousel-direction-desktop="down" data-carousel-direction-mobile="right">
                <div class="carousel-inner">
                    <img src="{% static 'core/img/hero_carousel/left_1.jpg' %}" alt="Wedding Image 1" class="carousel-item">
                    <img src="{% static 'core/img/hero_carousel/left_2.jpg' %}" alt="Wedding Image 2" class="carousel-item">
                    <img src="{% static 'core/img/hero_carousel/left_3.jpg' %}" alt="Wedding Image 3" class="carousel-item">
                    <img src="{% static 'core/img/hero_carousel/left_4.jpg' %}" alt="Wedding Image 4" class="carousel-item">
                    <img src="{% static 'core/img/hero_carousel/left_5.jpg' %}" alt="Wedding Image 5" class="carousel-item">
                    {# Add more 'right_' images here if you have them, for a smoother loop #}
                </div>
            </div>

        </div>
    </div>
</section>

{# Top Gallery Section - From Struct 1 #}
<section class="container py-5">
    <h2 class="section-title">Our Favorite Moments</h2>
    <div class="row">
        {% for photo in gallery_photos_top %}
            <div class="col-md-3 col-sm-6 mb-4">
                <div class="card gallery-card">
                    <img src="{{ photo.image.url }}" class="card-img-top" alt="{{ photo.title|default:'Featured Image' }}">
                    <div class="card-body">
                        <h5 class="card-title text-center">{{ photo.title|default:"Favorite Moment" }}</h5>
                    </div>
                </div>
            </div>
        {% empty %}
            {# Fallback if there are no featured photos #}
            <div class="col-12 text-center">
                <p class="text-muted">No favorite moments have been featured yet!</p>
            </div>
        {% endfor %}
    </div>
</section>

{# "Our Journey Together" Section - From Design 2 #}
<section class="journey-section">
    <div class="container">
        <h2 class="mb-4">Our Journey Together</h2>
        <p class="lead">Every step, every laugh, every memory leads us here. We can't wait for our next chapter!</p>
    </div>
</section>

{# Bottom Gallery Section / Featured img - From Struct 1 (repurposed for more photos) #}
<section class="container py-5">
    <h2 class="section-title">More Precious Memories</h2>
    <div class="row">
        {% for photo in gallery_photos_bottom %}
            <div class="col-md-3 col-sm-6 mb-4">
                <div class="card gallery-card">
                    <img src="{{ photo.image.url }}" class="card-img-top" alt="{{ photo.title|default:'Featured Image' }}">
                    <div class="card-body">
                        <h5 class="card-title text-center">{{ photo.title|default:"Precious Memory" }}</h5>
                    </div>
                </div>
            </div>
        {% empty %}
            {# Fallback if there are fewer than 5 featured photos #}
            <div class="col-12 text-center">
                <p class="text-muted">More memories coming soon!</p>
            </div>
        {% endfor %}
    </div>
</section>

{# Latest Articles Section - From Struct 1 #}
<section class="container py-5">
    <h2 class="section-title">Latest Updates & Stories</h2>
    <div class="row">
        {% for article in latest_articles %}
            <div class="col-md-4 mb-4">
                <div class="card article-card h-100 shadow-sm">
                    {# Display the article's header image or a placeholder #}
                    {% if article.header_image %}
                    <img src="{{ article.header_image.url }}" class="card-img-top article-img" alt="{{ article.title }}">
                    {% else %}
                    <img src="{% static 'core/img/article-placeholder.jpg' %}" class="card-img-top article-img" alt="Article Placeholder">
                    {% endif %}
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">{{ article.title }}</h5>
                        <h6 class="card-subtitle mb-2 text-muted">
                            By {{ article.author.username|default:"Unknown" }} | {{ article.published_date|date:"F d, Y" }}
                        </h6>
                        <div class="flex-grow-1">
                            <p class="card-text">{{ article.content|safe|striptags|truncatechars:140 }}</p>
                        </div>
                        <div class="mt-auto">
                            <a href="{% url 'article_detail' slug=article.slug %}" class="btn btn-primary btn-sm">Read More</a>
                        </div>
                    </div>
                </div>
            </div>
        {% empty %}
            {# This message will display if there are no articles in the database #}
            <div class="col-12 text-center">
                <p class="text-muted">No articles published yet. Check back soon!</p>
            </div>
        {% endfor %}
    </div>
    
    {# New link to view all articles #}
    <div class="text-center mt-4">
        <a href="{% url 'article_list' %}" class="btn btn-primary btn-lg">View All Articles</a>
    </div>
</section>

{# Wedding Location / Map Section - From Struct 1 & Design 2 #}
<section class="container py-5">
    <h2 class="section-title">Wedding Location</h2>
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card p-4 mb-4 shadow-sm">
                <h4 class="card-title text-center mb-3">Find Us Here!</h4>
                <p class="text-center lead">Join us at:</p>
                <p class="text-center fw-bold">{{ wedding_location }}</p>

                <div class="map-container mb-4">
                    <iframe
                        src="{{ map_embed_url }}"
                        allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>
                <p class="text-center">
                    <a href="https://www.google.com/maps/search/?api=1&query={{ wedding_location|urlencode }}" target="_blank" class="btn btn-outline-secondary">Get Directions</a>
                </p>
            </div>
        </div>
    </div>
</section>

{% endblock content %}
{% block extra_js %}
    <script src="{% static 'core/js/hero_carousel.js' %}"></script>
{% endblock extra_js %}